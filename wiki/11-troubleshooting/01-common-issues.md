# よくある問題

## 概要

notocord で発生しやすい問題とその解決方法を説明します。

## 認証関連

### 認証コードが届かない

**症状**: 「認証コードを送信」後、メールが届かない。

**原因と解決策**:

1. **迷惑メールフォルダを確認**
   - メールが迷惑メールに振り分けられている可能性

2. **メールアドレスを確認**
   - 入力したメールアドレスに誤りがないか

3. **SMTP 設定を確認**（管理者向け）
   - Supabase Dashboard → Auth → SMTP Settings

4. **Supabase のレート制限**
   - 短時間に複数回送信すると制限される
   - しばらく待ってから再試行

### 認証コードが無効

**症状**: 認証コードを入力しても「無効なコード」エラー。

**原因と解決策**:

1. **有効期限切れ**
   - 認証コードは数分で期限切れ
   - 新しいコードを再送信

2. **入力ミス**
   - 数字のみ正確に入力
   - コピー&ペーストを推奨

3. **別のコードを使用**
   - 最新のコードを使用しているか確認

### アカウントが見つからない

**症状**: ログイン時に「アカウントが見つかりません」エラー。

**原因と解決策**:

1. **未登録のメールアドレス**
   - 管理者にアカウント作成を依頼

2. **メールアドレスの誤り**
   - 正確なメールアドレスを確認

3. **アカウントが無効**
   - 管理者に有効化を依頼

## 申請関連

### 申請が作成できない

**症状**: 申請ボタンを押してもエラーが表示される。

**原因と解決策**:

1. **バリデーションエラー**
   - エラーメッセージを確認
   - 入力値を修正

2. **重複申請**
   - 同じ日時/週の申請が存在
   - 既存申請を確認

3. **過去日の申請**
   - 過去の日付は申請不可
   - 有効な日付を選択

4. **セッション切れ**
   - ページを再読み込み
   - 再ログイン

### 申請が編集できない

**症状**: 申請の編集ボタンが表示されない、または押せない。

**原因と解決策**:

1. **ステータスが pending 以外**
   - 承認済み/却下/取り下げ済みの申請は編集不可

2. **権限の問題**
   - 自分の申請のみ編集可能

### 申請が表示されない

**症状**: 作成した申請が一覧に表示されない。

**原因と解決策**:

1. **フィルタ設定**
   - 「過去を表示」を有効化
   - タブ設定を確認

2. **キャッシュ**
   - ページを再読み込み
   - `fetchRequests({ force: true })`

3. **権限**
   - staff は自分の申請のみ表示

## 承認関連

### 承認ボタンが表示されない

**症状**: 承認画面で承認ボタンが見えない。

**原因と解決策**:

1. **権限不足**
   - reviewer または admin ロールが必要
   - 管理者に権限付与を依頼

2. **申請のステータス**
   - 取り下げ/却下済みは承認不可

### 変更承認でエラー

**症状**: 変更承認時にエラーが発生。

**原因と解決策**:

1. **変更理由が未入力**
   - Fix の変更承認には理由必須

2. **時間のバリデーション**
   - 開始 < 終了 を確認
   - 8時間以内か確認

## パフォーマンス関連

### ページの読み込みが遅い

**症状**: ページの表示に時間がかかる。

**原因と解決策**:

1. **ネットワーク**
   - 接続状況を確認
   - 別のネットワークを試す

2. **データ量**
   - 過去のデータが多い場合は読み込みに時間がかかる

3. **キャッシュ**
   - ブラウザのキャッシュをクリア

### 画面が更新されない

**症状**: 操作後に画面が更新されない。

**原因と解決策**:

1. **JavaScript エラー**
   - 開発者ツールでエラーを確認

2. **状態の不整合**
   - ページを再読み込み
   - ログアウト→再ログイン

## 環境関連

### ローカル開発環境が起動しない

**症状**: `pnpm dev` でエラー。

**原因と解決策**:

1. **依存関係**
   ```bash
   rm -rf node_modules
   pnpm install
   ```

2. **環境変数**
   - `.env.local` の設定を確認

3. **ポート競合**
   ```bash
   pnpm dev -p 3001
   ```

### ビルドエラー

**症状**: `pnpm build` でエラー。

**原因と解決策**:

1. **TypeScript エラー**
   - 型エラーを修正

2. **依存関係**
   - バージョンの不整合を確認

3. **環境変数**
   - ビルド時に必要な環境変数を確認

## 問い合わせ

上記で解決しない場合:

1. **ログを確認**
   - ブラウザのコンソール
   - サーバーログ

2. **再現手順を記録**
   - どの操作で発生したか
   - エラーメッセージ

3. **管理者に連絡**
   - 問題の詳細を報告

## 関連ドキュメント

- [デバッグ手法](../08-development/04-debugging.md)
- [監視・ログ](../10-operations/01-monitoring.md)
- [FAQ](../12-faq/01-general.md)
