# シフト申請（スタッフ向け）

## 概要

スタッフは、自身のシフト希望を申請できます。申請タイプは、アカウント作成時に設定された `request_type` に基づき、Fix または Flex のいずれかになります。

## 申請タイプ

### Fix タイプ（固定シフト）

特定の日時のシフトを申請します。

| 項目 | 説明 |
|------|------|
| 対象 | 特定の日付・時間帯 |
| 入力項目 | 日付、開始時刻、終了時刻、メッセージ |
| 制限 | 最大8時間、過去日不可、3ヶ月先まで |

### Flex タイプ（フレックスシフト）

週単位での希望勤務時間を申請します。

| 項目 | 説明 |
|------|------|
| 対象 | 特定の週（ISO週番号） |
| 入力項目 | 対象週、希望時間数、メッセージ |
| 制限 | 1〜40時間、過去週不可、3ヶ月先まで |

## 申請作成

### 画面へのアクセス

1. ナビゲーションの「申請」タブをタップ
2. `/new` 画面が表示される

### Fix 申請の入力

```
┌─────────────────────────────┐
│ 新規シフト申請               │
├─────────────────────────────┤
│ 日付                        │
│ ┌─────────────────────────┐ │
│ │ 2026年3月1日             │ │
│ └─────────────────────────┘ │
│                             │
│ 開始時刻     終了時刻        │
│ ┌──────┐    ┌──────┐       │
│ │ 09:00 │    │ 17:00 │       │
│ └──────┘    └──────┘       │
│                             │
│ メッセージ（任意）           │
│ ┌─────────────────────────┐ │
│ │                         │ │
│ └─────────────────────────┘ │
│                             │
│      ［ 申請する ］         │
└─────────────────────────────┘
```

#### 入力項目

| 項目 | 必須 | 説明 |
|------|:----:|------|
| 日付 | ✅ | カレンダーから選択または手入力 |
| 開始時刻 | ✅ | HH:MM 形式 |
| 終了時刻 | ✅ | HH:MM 形式 |
| メッセージ | - | 任意のコメント |

#### バリデーション

- 終了時刻 > 開始時刻
- 勤務時間 ≤ 8時間
- 過去日は不可
- 3ヶ月先超は不可
- 既存申請との重複不可

### Flex 申請の入力

```
┌─────────────────────────────┐
│ 新規シフト申請               │
├─────────────────────────────┤
│ 対象週                      │
│ ┌─────────────────────────┐ │
│ │ 2026年 第10週            │ │
│ │ (3/2〜3/8)               │ │
│ └─────────────────────────┘ │
│                             │
│ 希望時間数                   │
│ ┌─────────────────────────┐ │
│ │ 20 時間                  │ │
│ └─────────────────────────┘ │
│                             │
│ メッセージ（任意）           │
│ ┌─────────────────────────┐ │
│ │                         │ │
│ └─────────────────────────┘ │
│                             │
│      ［ 申請する ］         │
└─────────────────────────────┘
```

#### 入力項目

| 項目 | 必須 | 説明 |
|------|:----:|------|
| 対象週 | ✅ | ドロップダウンから選択 |
| 希望時間数 | ✅ | 1〜40の整数 |
| メッセージ | - | 任意のコメント |

#### バリデーション

- 1 ≤ 希望時間数 ≤ 40
- 過去週は不可
- 3ヶ月先超は不可
- 同一週の重複申請不可（pending/approved）

## 申請一覧

### 画面へのアクセス

1. ナビゲーションの「履歴」タブをタップ
2. `/my` 画面が表示される

### 表示切り替え

| タブ | 表示内容 |
|------|---------|
| すべて | すべての申請 |
| 確定 | 承認済みの申請のみ |

### 過去の申請

- 「過去を表示」トグルで過去の申請を表示
- デフォルトでは過去7日以内の未承認申請を表示

### ソート順

- 勤務日が近い順（Fix: 開始日時、Flex: 週開始日）

## 申請詳細

### 表示情報

```
┌─────────────────────────────┐
│ 申請詳細                     │
├─────────────────────────────┤
│ ステータス: 保留中           │
│                             │
│ 【申請内容】                 │
│ 日付: 2026/03/01            │
│ 時間: 09:00 - 17:00         │
│ メッセージ: よろしくお願いします │
│                             │
│ 作成日時: 2026/02/25 10:00   │
│                             │
│ ［ 編集 ］ ［ 取り下げ ］    │
│                             │
│ ▼ 変更履歴を見る            │
└─────────────────────────────┘
```

## 申請編集

### 条件
- ステータスが「保留中（pending）」の場合のみ編集可能

### 手順

1. 申請詳細画面で「編集」をタップ
2. 内容を変更
3. 「保存」をタップ

### 編集可能な項目

| タイプ | 編集可能項目 |
|--------|-------------|
| Fix | 日付、開始時刻、終了時刻、メッセージ |
| Flex | 対象週、希望時間数、メッセージ |

## 申請取り下げ

### 条件
- ステータスが「保留中（pending）」の場合のみ取り下げ可能
- 承認済みの申請は取り下げ不可（レビュワー/管理者に連絡）

### 手順

1. 申請詳細画面で「取り下げ」をタップ
2. 取り下げ理由を入力（必須）
3. 確認して実行

### 警告表示

直近2日以内のシフトを取り下げる場合：
- 「直近のシフトです。連絡を取ることを推奨します」という警告が表示

## ステータスの意味

| ステータス | 説明 | 日本語表示 |
|-----------|------|-----------|
| pending | 承認待ち | 保留中 |
| approved | 承認済み | 確定 |
| rejected | 却下 | 却下 |
| withdrawn | 取り下げ | 取り下げ |

## 変更履歴

各申請の詳細画面から「変更履歴を見る」で以下を確認できます：

- 作成日時・作成者
- 編集履歴
- 承認・却下履歴
- 取り下げ履歴

## よくある質問

### Q: 申請タイプを変更できますか？
A: いいえ。申請タイプはアカウント設定で固定されています。変更が必要な場合は管理者にお問い合わせください。

### Q: 過去の日付でシフト申請できますか？
A: いいえ。過去日の申請はできません。

### Q: 却下された申請を再度申請できますか？
A: はい。却下・取り下げ後は同じ日/週で再度申請できます。

## 関連ドキュメント

- [基本操作](../01-getting-started/04-basic-operations.md)
- [シフト承認](02-reviewer-approval.md)
- [よくある質問](../12-faq/01-general.md)
