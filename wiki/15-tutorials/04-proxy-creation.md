# チュートリアル: 代理申請の作成

## 概要

このチュートリアルでは、レビュワーまたは管理者としてスタッフに代わってシフト申請を作成する手順を説明します。

## 用途

- スタッフが直接申請できない状況
- 口頭や電話で受けた依頼の記録
- 急なシフト調整

## 前提条件

- reviewer または admin ロールでログインしている
- 対象のスタッフアカウントが存在する

## ステップ 1: 代理申請画面に移動

### 1.1 ログイン

レビュワーまたは管理者のアカウントでログインします。

### 1.2 「代理」タブをタップ

ナビゲーションの「代理」タブをタップします。

## ステップ 2: スタッフを選択

### 2.1 スタッフ一覧を確認

有効なスタッフの一覧が表示されます。

### 2.2 対象スタッフをタップ

申請を作成するスタッフを選択します。

### 2.3 申請フォームを確認

選択したスタッフの `request_type` に応じたフォームが表示されます：
- Fix タイプ → 日時入力フォーム
- Flex タイプ → 週・時間数入力フォーム

## ステップ 3: 申請内容を入力

### Fix タイプの場合

#### 3.1 日付を選択

カレンダーから日付を選択します。

#### 3.2 時間を入力

開始時刻と終了時刻を入力します。
- 最大8時間まで
- 重複不可

#### 3.3 メッセージを入力（任意）

必要に応じてメッセージを入力します。

### Flex タイプの場合

#### 3.1 対象週を選択

ドロップダウンから対象週を選択します。

#### 3.2 時間数を入力

1〜40時間の範囲で入力します。

#### 3.3 メッセージを入力（任意）

必要に応じてメッセージを入力します。

## ステップ 4: 申請を作成

### 4.1 内容を確認

入力内容に誤りがないか確認します。

### 4.2 「作成」をタップ

ボタンをタップして申請を作成します。

### 4.3 完了を確認

「申請を作成しました」というメッセージが表示されます。

## 代理申請の特徴

### 即時承認

代理申請は作成時に自動的に「承認済み」となります。

- ステータス: `approved`
- 決定タイプ: `approve`

### 履歴への記録

代理申請は履歴に「代理作成」として記録されます：

```
代理作成 by 管理者A
→ 確定（承認）
```

### 作成者と申請者

- 作成者（created_by）: 代理作成した人
- 申請者（user_id）: スタッフ

## 代理申請後の操作

### 内容の変更

1. 「承認」タブで申請を検索
2. 申請をタップ
3. 内容を変更
4. 「確定」をタップ

### 取り消し

1. 「承認」タブで申請を検索
2. 申請をタップ
3. 「取り消し」を選択
4. 理由を入力
5. 「確定」をタップ

## バリデーション

代理申請にも通常の申請と同じバリデーションが適用されます：

### Fix
- 終了時刻 > 開始時刻
- 勤務時間 ≤ 8時間
- 過去日不可
- 重複不可

### Flex
- 1 ≤ 時間数 ≤ 40
- 過去週不可
- 同一週重複不可

## ベストプラクティス

### 1. 記録の正確性

口頭で受けた内容を正確に入力しましょう。

### 2. メッセージの活用

代理申請の経緯をメッセージに記載しておくと、後から確認しやすくなります。

### 3. 事後連絡

代理申請後は、スタッフに内容を確認してもらうことを推奨します。

## よくある質問

### Q: スタッフが表示されない

A: 以下を確認してください：
- スタッフのアカウントが有効か
- スタッフのロールが `staff` か

### Q: 申請タイプを変更できますか？

A: いいえ。スタッフの `request_type` に応じたフォームのみ使用できます。

### Q: 過去の日付で代理申請できますか？

A: いいえ。過去日の申請はできません。

## 関連ドキュメント

- [代理申請](../03-features/04-proxy-creation.md)
- [シフト承認](../03-features/02-reviewer-approval.md)
- [管理者向け FAQ](../12-faq/03-admin-faq.md)
