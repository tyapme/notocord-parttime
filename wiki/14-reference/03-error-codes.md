# エラーコード一覧

## 概要

notocord で発生するエラーコードとその対処方法を説明します。

## 認証エラー

| コード | メッセージ | 原因 | 対処 |
|--------|-----------|------|------|
| AUTH_001 | アカウントが見つかりません | 未登録メール | 管理者に連絡 |
| AUTH_002 | アカウントが無効です | active=false | 管理者に連絡 |
| AUTH_003 | 認証コードが無効です | OTP 不正/期限切れ | 再送信 |
| AUTH_004 | セッションが切れました | トークン期限切れ | 再ログイン |
| AUTH_005 | 認証が必要です | 未ログイン | ログイン |

## 権限エラー

| コード | メッセージ | 原因 | 対処 |
|--------|-----------|------|------|
| PERM_001 | 権限がありません | ロール不足 | 管理者に連絡 |
| PERM_002 | 管理者権限が必要です | admin以外 | 管理者に連絡 |
| PERM_003 | 他のユーザーの申請は編集できません | 本人以外 | 正しいアカウントでログイン |
| PERM_004 | この操作は許可されていません | RLS拒否 | 権限確認 |

## バリデーションエラー

### 共通

| コード | メッセージ | 原因 | 対処 |
|--------|-----------|------|------|
| VAL_001 | 必須項目です | 未入力 | 値を入力 |
| VAL_002 | 形式が不正です | フォーマットエラー | 正しい形式で入力 |

### Fix 申請

| コード | メッセージ | 原因 | 対処 |
|--------|-----------|------|------|
| FIX_001 | 終了時刻は開始時刻より後にしてください | 開始≧終了 | 時刻を修正 |
| FIX_002 | 勤務時間は8時間以内にしてください | 8時間超過 | 時間を短縮 |
| FIX_003 | 過去の日付では申請できません | 過去日 | 有効な日付を選択 |
| FIX_004 | 3ヶ月以上先の日付では申請できません | 3ヶ月超 | 有効な日付を選択 |
| FIX_005 | この時間帯は既に申請されています | 重複 | 別の時間を選択 |

### Flex 申請

| コード | メッセージ | 原因 | 対処 |
|--------|-----------|------|------|
| FLEX_001 | 時間数は1〜40の範囲で入力してください | 範囲外 | 有効な値を入力 |
| FLEX_002 | 過去の週では申請できません | 過去週 | 有効な週を選択 |
| FLEX_003 | 3ヶ月以上先の週では申請できません | 3ヶ月超 | 有効な週を選択 |
| FLEX_004 | この週は既に申請されています | 重複 | 既存申請を確認 |

### 承認

| コード | メッセージ | 原因 | 対処 |
|--------|-----------|------|------|
| REV_001 | 変更理由は必須です | Fixのmodify時 | 理由を入力 |
| REV_002 | 取り下げ理由は必須です | 取り下げ時 | 理由を入力 |
| REV_003 | この申請は既に処理されています | 二重処理 | 再読み込み |

## システムエラー

| コード | メッセージ | 原因 | 対処 |
|--------|-----------|------|------|
| SYS_001 | サーバーエラーが発生しました | 内部エラー | しばらく待って再試行 |
| SYS_002 | ネットワークエラーが発生しました | 接続問題 | 接続を確認 |
| SYS_003 | データベースエラーが発生しました | DB問題 | 管理者に連絡 |
| SYS_004 | タイムアウトしました | 処理超過 | 再試行 |

## HTTP ステータスコード

| コード | 意味 | 説明 |
|--------|------|------|
| 200 | OK | 成功 |
| 201 | Created | 作成成功 |
| 400 | Bad Request | リクエストエラー |
| 401 | Unauthorized | 認証エラー |
| 403 | Forbidden | 権限エラー |
| 404 | Not Found | リソース未検出 |
| 409 | Conflict | 競合 |
| 422 | Unprocessable Entity | バリデーションエラー |
| 429 | Too Many Requests | レート制限 |
| 500 | Internal Server Error | サーバーエラー |

## エラーレスポンス形式

### API Routes

```json
{
  "ok": false,
  "error": "エラーメッセージ",
  "code": "AUTH_001"
}
```

### Supabase RPC

```json
{
  "data": null,
  "error": {
    "message": "Permission denied",
    "details": null,
    "hint": null,
    "code": "42501"
  }
}
```

## 関連ドキュメント

- [よくある問題](../11-troubleshooting/01-common-issues.md)
- [デバッグ手法](../08-development/04-debugging.md)
- [API 概要](../05-api/01-overview.md)
